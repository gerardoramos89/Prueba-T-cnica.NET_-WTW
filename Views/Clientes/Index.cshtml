@model IEnumerable<Clientes>
@{
    decimal totalfactura = ViewBag.totalfactura;
    decimal impuesto = ViewBag.impuesto;
    decimal subtotal = ViewBag.subtotal;
}





<h1>Facturas</h1>
<form id="miFormulario">
<p>
    <button id="nuevafactura" class="btn btn-success">Nuea Facrtura</button>
</p>
<div>

    <table class="table">
        <thead>
            <tr>
                <th>Cliente </th>
                <th>Numero de Factura</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                        <select id="selectClientes" name="selectClientes">

                        @foreach (var cliente in Model)
                        {
                            <option value="@cliente.Id">@cliente.rfc</option>
                        }
                    </select>
            </td>
                <td>
                    <input type="number" placeholder="Numero" name="usernameField" id="numerofactura" runat="server">
                </td>
            </tr>

        </tbody>
    </table>
</div>
<a asp-action="Index" class="btn btn-info">Agregar producto</a>
<table class="table">
    <thead>
        <tr>
            <th>Producto</th>
            <th>Precio Unitario</th>
            <th>Cantidad</th>
            <th>Imagen</th>
            <th>totales</th>
        </tr>
    </thead>
    <tr>
        <th>
                <select id="selectproducto1" name="selectproducto1">
                @foreach (var productos in ViewBag.productos)
                {
                    <option value="@productos.Id">@productos.nombreproducto</option>
                }
            </select>

        </th>

            <th>
                $
            @if (ViewBag.productos.Count > 0)
            {
                    <label id="preciounitario">@ViewBag.productos[0].preciounitario</label>
            }
            else
            {
                <label>No hay imágenes disponibles</label>
            }
        </th>
        <th>
                <select id="selectCantidadProducto1">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
        </th>
        <th>
            <img src="@ViewBag.productos[0].imagenproducto" alt="IMAGES" />


        </th>
        <th>
                $<label id="SubtotalProducto1"></label>
        </th>
    </tr>
    <tr>
        <th></th>
        <th></th>
        <th></th>
        <th>Sub Total</th>
        <th>
                $ <label id="SubtotalProductos">@subtotal</label>
        </th>
    </tr>
    <tr>
        <th></th>
        <th></th>
        <th></th>
        <th>Impuesto (19%)</th>
        <th>
                $<label id="impuesto">@impuesto</label>
        </th>
    </tr>
    <tr>
        <th></th>
        <th></th>
        <th></th>
        <th>Total</th>
        <th>
                $<label id="totalfactura">$ @totalfactura</label>
        </th>
    </tr>
</table>
</form>
<script>
    document.getElementById("nuevafactura").onclick = function () {
        document.getElementById("numerofactura").value = '';
    };
 
    var selectClientes = document.getElementById("selectClientes");

    selectClientes.addEventListener("change", function () {
        var selectedValue = selectClientes.value;
            alert("Valor seleccionado clientes: " + selectedValue);
        });

    var selectproducto1 = document.getElementById("selectproducto1");

    selectproducto1.addEventListener("change", function () {
        var selectedValue = selectproducto1.value;
        alert("Valor seleccionado producto1: " + selectedValue);
    });

    var selectCantidadProducto1 = document.getElementById("selectCantidadProducto1");


    selectCantidadProducto1.addEventListener("change", function () {
        var selectedCantidadProducto1 = selectCantidadProducto1.value;

        var preciounitarioproducto1 = document.getElementById("preciounitario");
        var Numeropreciounitarioproducto1 = parseFloat(preciounitarioproducto1.textContent);

        document.getElementById("SubtotalProducto1").textContent = selectedCantidadProducto1 * Numeropreciounitarioproducto1;

        document.getElementById("SubtotalProductos").textContent = selectedCantidadProducto1 * Numeropreciounitarioproducto1;

        document.getElementById("impuesto").textContent = ((selectedCantidadProducto1 * Numeropreciounitarioproducto1) * 19) / 100;

        document.getElementById("totalfactura").textContent = selectedCantidadProducto1 * Numeropreciounitarioproducto1 + ((selectedCantidadProducto1 * Numeropreciounitarioproducto1) * 19) / 100;

    });
</script>
<a asp-action="Index" class="btn btn-success">Guardar</a>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
